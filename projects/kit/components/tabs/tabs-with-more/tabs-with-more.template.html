<ng-container *ngIf="items.changes | async"></ng-container>
<div class="wrapper">
    <ng-container *ngFor="let item of items; let index = index">
        <div
            class="tab"
            (tui-tab-activate)="onActivate(index)"
            [class.tab_hidden]="index > lastVisibleIndex && index !== activeItemIndex"
        >
            <ng-container [ngTemplateOutlet]="item"></ng-container>
        </div>
    </ng-container>
    <tui-hosted-dropdown
        class="more_wrapper"
        [class.tab_hidden]="!isMoreVisible"
        [content]="dropdown"
        [(open)]="open"
    >
        <button
            tuiTab
            type="button"
            class="more"
            [class._active]="open"
            [tuiFocusable]="isMoreFocusable"
        >
            <span polymorpheus-outlet [content]="moreContent || more"></span>
        </button>
        <ng-template #more>
            {{moreWord$ | async}}
            <tui-svg
                src="tuiIconChevronDown"
                class="icon"
                [class.icon_rotated]="open"
            ></tui-svg>
        </ng-template>
    </tui-hosted-dropdown>
    <ng-template #dropdown>
        <div
            #element
            class="dropdown"
            (keydown.arrowUp.prevent)="onWrapperArrow($event.target, element, true)"
            (keydown.arrowDown.prevent)="onWrapperArrow($event.target, element, false)"
        >
            <ng-container *ngFor="let item of items; let index = index">
                <div (tui-tab-activate)="onClick(index)">
                    <ng-container
                        *ngIf="index > lastVisibleIndex && index !== activeItemIndex"
                        [ngTemplateOutlet]="item"
                    ></ng-container>
                </div>
            </ng-container>
        </div>
    </ng-template>
    <tui-underline *ngIf="underline" [element]="activeElement"></tui-underline>
</div>
